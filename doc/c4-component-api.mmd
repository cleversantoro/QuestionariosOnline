flowchart TB
    subgraph API [API Questionarios - Componentes]
      controllers[Controllers REST\nSurvey, Questions, Responses, Results, Users]
      appServices[Application Services\nSurveyService, QuestionService,\nResponseService, ResultsService, UserService]
      dtos[DTOs / Contracts\nQuestionarios.Application.DTOs]
      domainHelpers[Validacoes de dominio\nEntities + IDateTimeProvider]
      repos[Repositorios EF Core\nSurveyRepository, QuestionRepository,\nResponseRepository, ResultsRepository, UserRepository]
      cacheSvc[ICacheService\nInMemoryCacheService ou Redis]
      queueSvc[IQueueClient\nConsoleQueueClient ou Service Bus]
      dbCtx[QuestionariosDbContext\nEF Core]
    end

    controllers -->|Mapear HTTP <-> DTOs| appServices
    controllers --> dtos
    appServices -->|Persistencia| repos
    appServices -->|Cache de charts| cacheSvc
    appServices -->|Publicar ResponseMessage| queueSvc
    appServices --> domainHelpers

    repos --> dbCtx
    dbCtx --> sql[(SQL Server)]
    cacheSvc --> cache[(Cache)]
    queueSvc --> queue[(Fila de mensagens)]

    logs[Logs / metricas\nSerilog ou OpenTelemetry] -.-> controllers
    logs -.-> appServices
    logs -.-> repos
